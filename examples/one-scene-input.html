<!--
 ~ Copyright (c) 2011-2014 by Animatron.
 ~ All rights are reserved.
 ~
 ~ Animatron player is licensed under the MIT License, see LICENSE.
 -->

<!DOCTYPE html>
<html>
  <head>
    <title>The Animatron HTML5 Player Demo</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="shortcut icon" type="image/x-icon" href="../favicon.ico" />
    <link rel="stylesheet" href="./demo.css" type="text/css" />

    <script src="../src/vendor/matrix.js" type="text/javascript"></script>
    <script src="../src/vendor/font-detector.js" type="text/javascript"></script>
    <script src="../src/engine/dom-engine.js" type="text/javascript"></script>
    <script src="../src/anm.js" type="text/javascript"></script>
    <script src="../src/player.js" type="text/javascript"></script>
    <script src="../src/module/audio.js" type="text/javascript"></script>
    <!-- <script src="../src/module/collisions.js" type="text/javascript"></script> -->
    <script src="../src/module/scripting.js" type="text/javascript"></script>
    <script src="../src/import/animatron-importer.js" type="text/javascript"></script>

    <!-- <script src="../dist/bundle/animatron.js" type="text/javascript"></script> -->

    <script type="text/javascript">

      var DEFAULT_SCENE = '{"meta":{"id":"f7c22d52b55aaf5b09bb8598","created":1378730743740,"modified":1378730743540,"name":"New Project","copyright":"Copyright (c) by Ulric Wilfred","author":"Ulric Wilfred","description":"","duration":30,"numberOfScenes":1,"projectAccessType":"Public","projectAccessReadOnly":true},"anim":{"dimension":[550,450],"framerate":24,"background":"#ffffff","elements":[[2,"Scene1",30,[[1,"Layer 1","","","","",0,[]]]],[9,"",[[2,"Shape 2","","",[46.5,68.5],"",0,[[4,[],"","M202.5 278.853 L202.5 278.853 Z"]]],[3,"Shape 1","","",[58.5,55.5],"",0,[[4,[],"","M131.5 198.853 L131.5 198.853 Z"]]]]],[5,"#2291ea","","","M0 0 L93 0 L93 137 L0 137 L0 0 M0 0 Z"],[6,"#2291ea","","","M0 55.5 C0 24.848 26.191 0 58.5 0 C90.809 0 117 24.848 117 55.5 C117 86.152 90.809 111 58.5 111 C26.191 111 0 86.152 0 55.5 Z"],[2,"$$$LIBRARY$$$",30,[]]],"scenes":[0]}}';

      var player = null;
      var /*b = Builder._$, */C = anm.C;

      function createPlayer() {
          return anm.createPlayer('anm-player', { /*audioEnabled: false,*/
                                                  loadingMode: anm.C.LM_ONPLAY,
                                                  ribbonsColor: 'rgba(255,0,0,0.01)'
                                                  /*forceSceneSize: true*/
                                                  /*controlsEnabled: false, autoPlay: true*/ });
      }

      function load() {
          if (!player) return;

          var AnimatronImporter = anm.getImporter('animatron');

          var project = JSON.parse(document.getElementById('scene-input').value);

          // canvas0
          var importer = new AnimatronImporter();
          player.detach();
          //var importer = new AnimatronImporter();
          player = createPlayer();
          //player.setThumbnail('http://www.pixeljoint.com/files/icons/full/miniatfinn_big01.gif');
          //http://ilikeswhatilikes.files.wordpress.com/2013/09/adventure-time-2.jpg
          player.setThumbnail('http://hdwallcomp.com/wp-content/uploads/2014/04/Cute-Face-Adventure-Time-Cartoons-Wallpaper.png');
          //player.debug = true;
          player.load(project, importer);
          //var b = Builder._$;
          //player.load(b().band([2, 10])/*.modify(function() { throw new Error('Test'); })*/, 10);
          //player.play();
      }

      function start() {
          if (!window.__anm_conf) window.__anm_conf = {};
          window.__anm_conf.logImport = true;
          window.__anm_conf.logResMan = true;

          document.getElementById('scene-input').value = DEFAULT_SCENE;

          player = createPlayer();
          //load();
      }
    </script>
  </head>

  <body onload="start();">
    <h1 style="margin-bottom: 20px">The place to test one scene</h1>

    <!-- <canvas id="canvas" width="1080" height="1080"></canvas> -->
    <div id="anm-player" anm-width="540" anm-height="540"></div>

    <p style="float: right"><label for="scene-input">Scene JSON:</label><button onclick="load(this)">Load</button><textarea id="scene-input"></textarea></p>

    <div id="copyright" style="clear: both"><span>Â© 2011-2013 by Animatron.</span></div>

  </body>

</html>
