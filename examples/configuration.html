<!--
 ~ Copyright (c) 2011-2014 by Animatron.
 ~ All rights are reserved.
 ~
 ~ Animatron player is licensed under the MIT License, see LICENSE.
 -->

<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <link rel="shortcut icon" type="image/x-icon" href="../favicon.ico" />
    <!--<script type="text/javascript" language="javascript" src="http://player.animatron.com/latest/bundle/animatron.js"></script>-->
    <script src="../dist/bundle/animatron.min.js"></script>

    <script>
        var snapshotsUrl = 'https://clips.animatron-test.com/',
            defaultSnapshotId = '057f9821e527adaf005b6a2d64487cf0',
            snapshotId = defaultSnapshotId;

        var embedPrefix = '<iframe src="',
            embedPostfix = '" width="640" height="360" frameborder="0"></iframe>';

        var currentMode; // embed, config, publish, html

        function getElm(id) { return document.getElementById(id); }

        function switchMode(target) {
            if (currentMode) getElm('mode-' + currentMode).className = '';
            currentMode = target;
            getElm('mode-' + target).className = 'current';
        }

        function collectOptions() {
            var options = {};
            if (!getElm('opts-width').disabled) options.width = getElm('opts-width').value;
            if (!getElm('opts-height').disabled) options.height = getElm('opts-height').value;
            return options;
        }

        function getCode(options) {
            if (currentMode === 'embed') {
                var result = embedPrefix + snapshotsUrl + snapshotId + '?';
                if (options.width) embedPrefix += 'w=' + options.width;
                if (options.height) embedPrefix += 'h=' + options.height;
                result += embedPostfix;
                return result;
            }
        }

        function onChange() {
            snapshotId = getElm('snapshot-id').value;
            getElm('code').value = getCode(collectOptions());
        }

        function init() {
            getElm('snapshot-id').value = defaultSnapshotId;
            switchMode('embed');

            getElm('opts-width-default').addEventListener('click', function() { getElm('opts-width').disabled = this.checked; });
            getElm('opts-height-default').addEventListener('click', function() { getElm('opts-height').disabled = this.checked; });

            onChange();
        }

        var optionsMapper = {
            'embed': function() {}
        }

        var conversions = (function() {

            var numberOption = function(prop) { return function(o) { if (o[prop]) return o[prop]; } }

            return {
                'embed': {
                    width: numberOption('width'),
                }
            };

        })();

    </script>

    <style>
        body > label {
            display: block;
            font-size: 1.3em;
            font-weight: bold;
            margin: 20px 0;
        }

        #code-type a.current {
            color: #f00;
        }
    </style>
</head>
<body onload="init()">
    <label for="snapshot">Snapshot ID:</label>

    <form id="snapshot">
        <input type="text" id="snapshot-id"></input>
    </form>

    <label for="options">Options:</label>

    <form id="options">
        <label for="opts-width">Width:</label><input type="text" disabled id="opts-width" /><label for="opts-width-default">Default:</label><input type="checkbox" id="opts-width-default" checked /><br/>
        <label for="opts-height">Height:</label><input type="text" disabled id="opts-height" /><label for="opts-height-default">Default:</label><input type="checkbox" id="opts-height-default" checked />
    </form>

    <label for="code-type">Get code for:</label>

    <ul id="code-type">
        <li><a href="#embed" id="mode-embed" onclick="switchMode('embed')">Embedding</a></li>
        <li><a href="#config" id="mode-config" onclick="switchMode('config')">Player Configuration</a></li>
        <li><a href="#publish" id="mode-publish" onclick="switchMode('publish')">Publish URL</a></li>
        <li><a href="#html" id="mode-html" onclick="switchMode('html')">HTML Attributes</a></li>
    </ul>

    <label for="code">The Code:</label>
    <textarea id="code" cols="100" rows="10"></textarea>

    <label for="preview">Preview:</label>
</body>
