<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <style type="text/css">
        html, body {
            margin: 0;
            padding: 0;
        }
    </style>


    <script type="text/javascript">

        // >>> DIFF WITH ORIGINAL
        var _params_ = location.search ? location.search.substr(1) : null,
            _prefix_ = 'animatron-snapshots.s3.amazonaws.com';
        var _project_id_ = location.hash.substr(1);
        console.log(_params_, _project_id_);
        // <<< DIFF WITH ORIGINAL

        var start = (function() {

            return function() {
                try {
                    //_forcedJS('http://player.animatron.com/latest/bundle/animatron.js', function() {
                    _forcedJS('../dist/full/bundle/animatron.js', function() {
                        /*var w = parseInt(_width_);
                        var h = parseInt(_height_);
                        var qstring = '';
                        if (w > 0 && h > 0) {
                            qstring = '?w=' + w + '&h=' + h;
                        }
                        anm.Player.forSnapshot('canvas1', _contentUrl_ + qstring, new AnimatronImporter());*/
                        anm.Player.forSnapshot('canvas1', 'http://' + _prefix_ + '/' + _project_id_ +
                                                          (_params_ ? ('?' + _params_) : ''), new AnimatronImporter());
                    });
                } catch(e) {
                    if (console) console.error(e);
                    else alert(e.message);
                }
            }

            function _reportError(_e) {
                if (console) console.error(_e);
                else alert(_e.message);
            }

            function _forcedJS(_path, _then) {
                var scriptElm = document.createElement('script');
                scriptElm.type = 'text/javascript';
                scriptElm.async = 'async';
                scriptElm.src = _path + '?' + (new Date()).getTime();
                scriptElm.onload = scriptElm.onreadystatechange = (function() {
                    var _success = false;
                    return function() {
                        if ( !_success && (!this.readyState || (this.readyState == 'complete')) )
                        {
                            _success = true;
                            _then();
                        } else if (!_success) {
                            _reportError(new Error('Request failed: ' + this.readyState));
                        }
                    }
                })();
                scriptElm.onerror = _reportError;
                var headElm = document.head || document.getElementsByTagName('head')[0];
                headElm.appendChild(scriptElm);
            }

        })();
    </script>
</head>

<body onload="start();">
<canvas id="canvas1"></canvas>
</body>
</html>
