<!DOCTYPE html>  <html> <head>   <title>builder.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="builder.html">                 builder.js               </a>                                           <a class="source" href="player.html">                 player.js               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               builder.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Copyright (c) 2011-2013 by Animatron.</span>
<span class="cm"> * All rights are reserved.</span>
<span class="cm"> *</span>
<span class="cm"> * Animatron player is licensed under the MIT License, see LICENSE.</span>
<span class="cm"> *</span>
<span class="cm"> * @VERSION</span>
<span class="cm"> */</span>

<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="c1">// anonymous wrapper to exclude global context clash</span>

<span class="kd">var</span> <span class="nx">Path</span> <span class="o">=</span> <span class="nx">anm</span><span class="p">.</span><span class="nx">Path</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">Element</span> <span class="o">=</span> <span class="nx">anm</span><span class="p">.</span><span class="nx">Element</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">Text</span> <span class="o">=</span> <span class="nx">anm</span><span class="p">.</span><span class="nx">Text</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">C</span> <span class="o">=</span> <span class="nx">anm</span><span class="p">.</span><span class="nx">C</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">DU</span> <span class="o">=</span> <span class="nx">anm</span><span class="p">.</span><span class="nx">DU</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">MSeg</span> <span class="o">=</span> <span class="nx">anm</span><span class="p">.</span><span class="nx">MSeg</span><span class="p">,</span> <span class="nx">LSeg</span> <span class="o">=</span> <span class="nx">anm</span><span class="p">.</span><span class="nx">LSeg</span><span class="p">,</span> <span class="nx">CSeg</span> <span class="o">=</span> <span class="nx">anm</span><span class="p">.</span><span class="nx">CSeg</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">is</span> <span class="o">=</span> <span class="nx">anm</span><span class="p">.</span><span class="nx">_typecheck</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">modCollisions</span> <span class="o">=</span> <span class="nx">C</span><span class="p">.</span><span class="nx">MOD_COLLISIONS</span><span class="p">;</span> <span class="c1">// if defined, module exists</span>

<span class="kd">var</span> <span class="nx">__b_cache</span> <span class="o">=</span> <span class="p">{};</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>var deprecated = function(instead) { return new Error(instead ? 'Deprecated, use ' + instead + 'instead.' : 'Derpacated.') };</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>=============================================================================
=== BUILDER =================================================================</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <blockquote>
  <p>Builder % ()</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">function</span> <span class="nx">Builder</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">n</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">v</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Element</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">xdata</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span> <span class="k">instanceof</span> <span class="nx">Builder</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">n</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">n</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">v</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">deepClone</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">xdata</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">f</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_extractFill</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">f</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">s</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_extractStroke</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">s</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">__b$</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span> <span class="c1">// all done</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span> <span class="k">instanceof</span> <span class="nx">Element</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">n</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">v</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">xdata</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">obj</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">n</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">v</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Element</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">n</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">xdata</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">__b$</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">f</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_extractFill</span><span class="p">(</span><span class="nx">Builder</span><span class="p">.</span><span class="nx">DEFAULT_FILL</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">s</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_extractStroke</span><span class="p">(</span><span class="nx">Builder</span><span class="p">.</span><span class="nx">DEFAULT_STROKE</span><span class="p">);</span>
<span class="p">}</span>
<span class="nx">Builder</span><span class="p">.</span><span class="nx">_$</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">obj</span> <span class="k">instanceof</span> <span class="nx">Element</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">__b_cache</span><span class="p">[</span><span class="nx">obj</span><span class="p">.</span><span class="nx">id</span><span class="p">])</span> <span class="k">return</span> <span class="nx">__b_cache</span><span class="p">[</span><span class="nx">obj</span><span class="p">.</span><span class="nx">id</span><span class="p">];</span>
        <span class="k">return</span> <span class="p">(</span><span class="nx">__b_cache</span><span class="p">[</span><span class="nx">obj</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Builder</span><span class="p">(</span><span class="nx">obj</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="kd">var</span> <span class="nx">inst</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Builder</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
    <span class="nx">__b_cache</span><span class="p">[</span><span class="nx">inst</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">inst</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">Builder</span><span class="p">.</span><span class="nx">__path</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">val</span><span class="p">,</span> <span class="nx">join</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">is</span><span class="p">.</span><span class="nx">array</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span>
           <span class="o">?</span> <span class="nx">Builder</span><span class="p">.</span><span class="nx">path</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span>
           <span class="o">:</span> <span class="p">((</span><span class="nx">val</span> <span class="k">instanceof</span> <span class="nx">Path</span><span class="p">)</span> <span class="o">?</span> <span class="nx">val</span>
              <span class="o">:</span> <span class="nx">Path</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">val</span><span class="p">,</span> <span class="nx">join</span><span class="p">))</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>Builder.DEFAULT<em>STROKE = Path.BASE</em>STROKE;</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">DEFAULT_STROKE</span> <span class="o">=</span> <span class="nx">Path</span><span class="p">.</span><span class="nx">EMPTY_STROKE</span><span class="p">;</span>
<span class="nx">Builder</span><span class="p">.</span><span class="nx">DEFAULT_FILL</span> <span class="o">=</span> <span class="nx">Path</span><span class="p">.</span><span class="nx">BASE_FILL</span><span class="p">;</span>
<span class="nx">Builder</span><span class="p">.</span><span class="nx">DEFAULT_CAP</span> <span class="o">=</span> <span class="nx">Path</span><span class="p">.</span><span class="nx">DEFAULT_CAP</span><span class="p">;</span>
<span class="nx">Builder</span><span class="p">.</span><span class="nx">DEFAULT_JOIN</span> <span class="o">=</span> <span class="nx">Path</span><span class="p">.</span><span class="nx">DEFAULT_JOIN</span><span class="p">;</span>
<span class="nx">Builder</span><span class="p">.</span><span class="nx">DEFAULT_FFACE</span> <span class="o">=</span> <span class="nx">Text</span><span class="p">.</span><span class="nx">DEFAULT_FFACE</span><span class="p">;</span>
<span class="nx">Builder</span><span class="p">.</span><span class="nx">DEFAULT_FSIZE</span> <span class="o">=</span> <span class="nx">Text</span><span class="p">.</span><span class="nx">DEFAULT_FSIZE</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <ul>
<li>STRUCTURE *</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <blockquote>
  <p>builder.add % (what: Element | Builder) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">add</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">what</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">what</span> <span class="k">instanceof</span> <span class="nx">Element</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">what</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">what</span> <span class="k">instanceof</span> <span class="nx">Builder</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">what</span><span class="p">.</span><span class="nx">v</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <blockquote>
  <p>builder.addS % (what: Element | Builder) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">addS</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">what</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">what</span> <span class="k">instanceof</span> <span class="nx">Element</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">addS</span><span class="p">(</span><span class="nx">what</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">what</span> <span class="k">instanceof</span> <span class="nx">Builder</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">addS</span><span class="p">(</span><span class="nx">what</span><span class="p">.</span><span class="nx">v</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <blockquote>
  <p>builder.remove % (what: Element | Builder) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">remove</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">what</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">what</span> <span class="k">instanceof</span> <span class="nx">Element</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">what</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">what</span> <span class="k">instanceof</span> <span class="nx">Builder</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">what</span><span class="p">.</span><span class="nx">v</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Don\&#39;t know what to remove&#39;</span><span class="p">);</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <ul>
<li>SHAPES *</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>TODO: move shapes to B.P.rect/... ?</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <blockquote>
  <p>builder.path % (path: String | Path,
                    [pt: Array[2,Integer]]) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">path</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">pt</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">Builder</span><span class="p">.</span><span class="nx">__path</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">path</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">path</span> <span class="o">=</span> <span class="nx">path</span><span class="p">;</span>
    <span class="nx">path</span><span class="p">.</span><span class="nx">normalize</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">reg</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">pos</span> <span class="o">=</span> <span class="nx">pt</span> <span class="o">||</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">path</span><span class="p">.</span><span class="nx">fill</span><span class="p">)</span> <span class="p">{</span> <span class="nx">path</span><span class="p">.</span><span class="nx">fill</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">f</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">f</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">fill</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">path</span><span class="p">.</span><span class="nx">stroke</span><span class="p">)</span> <span class="p">{</span> <span class="nx">path</span><span class="p">.</span><span class="nx">stroke</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">s</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">s</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">stroke</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <blockquote>
  <p>builder.rect % (pt: Array[2,Integer],
                    rect: Array[2,Integer] | Integer) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">rect</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">pt</span><span class="p">,</span> <span class="nx">rect</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">rect</span> <span class="o">=</span> <span class="nx">is</span><span class="p">.</span><span class="nx">array</span><span class="p">(</span><span class="nx">rect</span><span class="p">)</span> <span class="o">?</span> <span class="nx">rect</span> <span class="o">:</span> <span class="p">[</span> <span class="nx">rect</span><span class="p">,</span> <span class="nx">rect</span> <span class="p">];</span>
    <span class="kd">var</span> <span class="nx">w</span> <span class="o">=</span> <span class="nx">rect</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">h</span> <span class="o">=</span> <span class="nx">rect</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">path</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="nx">w</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
               <span class="p">[</span><span class="nx">w</span><span class="p">,</span> <span class="nx">h</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="nx">h</span><span class="p">],</span>
               <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="nx">pt</span><span class="p">);</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>TODO:</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="cm">/* Builder.prototype.oval = function(pt, radius, ratio) {</span>

<span class="cm">//DIVIDER</span>
<span class="cm">} */</span>
<span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">circle</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">pt</span><span class="p">,</span> <span class="nx">radius</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">pos</span> <span class="o">=</span> <span class="nx">pt</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">reg</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">__bounds</span> <span class="o">=</span> <span class="p">[</span> <span class="o">-</span><span class="nx">radius</span><span class="p">,</span> <span class="o">-</span><span class="nx">radius</span><span class="p">,</span> <span class="nx">radius</span><span class="p">,</span> <span class="nx">radius</span><span class="p">];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">paint</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">.</span><span class="nx">__b$</span><span class="p">;</span>
            <span class="nx">DU</span><span class="p">.</span><span class="nx">qDraw</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="nx">b</span><span class="p">.</span><span class="nx">s</span><span class="p">,</span> <span class="nx">b</span><span class="p">.</span><span class="nx">f</span><span class="p">,</span>
                <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                    <span class="nx">ctx</span><span class="p">.</span><span class="nx">arc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">radius</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
                <span class="p">});</span>
        <span class="p">});</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">modCollisions</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">reactAs</span><span class="p">(</span>
            <span class="nx">Builder</span><span class="p">.</span><span class="nx">arcPath</span><span class="p">(</span><span class="mi">0</span><span class="cm">/*pt[0]*/</span><span class="p">,</span><span class="mi">0</span><span class="cm">/*pt[1]*/</span><span class="p">,</span><span class="nx">radius</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">));</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <blockquote>
  <p>builder.oval % (pt: Array[2,Integer],
                        radius: Float) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">image</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">pt</span><span class="p">,</span> <span class="nx">src</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">pos</span> <span class="o">=</span> <span class="nx">pt</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">src</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">image</span> <span class="o">=</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <blockquote>
  <p>builder.image % (pt: Array[2,Integer],
                     src: String) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre>           <span class="nx">Element</span><span class="p">.</span><span class="nx">imgFromUrl</span><span class="p">(</span><span class="nx">src</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">image</span><span class="p">.</span><span class="nx">isReady</span><span class="p">)</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">src</span><span class="p">);</span>
        <span class="k">else</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">imgFromUrl</span><span class="p">(</span><span class="nx">src</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
        <span class="k">try</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">image</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">src</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span> <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Image at &#39;</span> <span class="o">+</span> <span class="nx">src</span> <span class="o">+</span> <span class="s1">&#39; is not accessible&#39;</span><span class="p">);}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span>
<span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">sprite</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">pt</span><span class="p">,</span> <span class="nx">src</span><span class="p">,</span> <span class="nx">sheet</span><span class="p">,</span> <span class="nx">frame</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">pos</span> <span class="o">=</span> <span class="nx">pt</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">sheet</span> <span class="o">=</span> <span class="nx">sheet</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">sprite</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">frame</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">frame</span> <span class="o">=</span> <span class="nx">frame</span><span class="p">;</span>
    <span class="k">else</span> <span class="nx">frame</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">src</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">image</span> <span class="o">=</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>width/height olny will be known when image will be loaded</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">Element</span><span class="p">.</span><span class="nx">imgFromUrl</span><span class="p">(</span><span class="nx">src</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">image</span><span class="p">.</span><span class="nx">isReady</span><span class="p">)</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">src</span><span class="p">);</span>
        <span class="k">else</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">imgFromUrl</span><span class="p">(</span><span class="nx">src</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">img</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">w</span><span class="p">,</span> <span class="nx">h</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">sheet</span> <span class="k">instanceof</span> <span class="nb">Array</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">w</span> <span class="o">=</span> <span class="nx">sheet</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
                    <span class="nx">h</span> <span class="o">=</span> <span class="nx">sheet</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
                <span class="p">}</span> <span class="k">else</span> <span class="nx">w</span> <span class="o">=</span> <span class="nx">sheet</span><span class="p">;</span>
                <span class="nx">b</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">$</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">dimen</span> <span class="o">=</span> <span class="p">[</span><span class="nx">w</span><span class="p">,</span> <span class="nx">h</span><span class="p">];</span>
                <span class="nx">b</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">$</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">ratio</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
                <span class="nx">b</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">prepare</span><span class="p">();</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>width/height olny will be known when image will be loaded</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="p">});</span>
        <span class="k">try</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">image</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">src</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span> <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Image at &#39;</span> <span class="o">+</span> <span class="nx">src</span> <span class="o">+</span> <span class="s1">&#39; is not accessible&#39;</span><span class="p">);}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>if (callback) callback(this);</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">text</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">pt</span><span class="p">,</span> <span class="nx">lines</span><span class="p">,</span> <span class="nx">size</span><span class="p">,</span> <span class="nx">font</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">pos</span> <span class="o">=</span> <span class="nx">pt</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">lines</span> <span class="k">instanceof</span> <span class="nx">Text</span> <span class="o">?</span> <span class="nx">lines</span>
                     <span class="o">:</span> <span class="k">new</span> <span class="nx">Text</span><span class="p">(</span><span class="nx">lines</span><span class="p">,</span> <span class="nx">Builder</span><span class="p">.</span><span class="nx">font</span><span class="p">(</span><span class="nx">font</span><span class="p">,</span> <span class="nx">size</span><span class="p">));</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">text</span> <span class="o">=</span> <span class="nx">text</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">reg</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">text</span><span class="p">.</span><span class="nx">stroke</span><span class="p">)</span> <span class="p">{</span> <span class="nx">text</span><span class="p">.</span><span class="nx">stroke</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">s</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">s</span> <span class="o">=</span> <span class="nx">text</span><span class="p">.</span><span class="nx">stroke</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">text</span><span class="p">.</span><span class="nx">fill</span><span class="p">)</span> <span class="p">{</span> <span class="nx">text</span><span class="p">.</span><span class="nx">fill</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">f</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">f</span> <span class="o">=</span> <span class="nx">text</span><span class="p">.</span><span class="nx">fill</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <blockquote>
  <p>builder.text % (pt: Array[2,Integer],
                    lines: String | Array | Text,
                    [size: Float],
                    [font: String | Array]) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <ul>
<li>FILL &amp; STROKE *</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">fill</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fval</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">f</span> <span class="o">=</span> <span class="p">((</span><span class="k">typeof</span> <span class="nx">fval</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span>
              <span class="o">?</span> <span class="p">{</span> <span class="nx">color</span><span class="o">:</span> <span class="nx">fval</span> <span class="p">}</span>
              <span class="o">:</span> <span class="p">(</span><span class="nx">fval</span><span class="p">.</span><span class="nx">r</span> <span class="o">?</span> <span class="p">{</span> <span class="s1">&#39;rgrad&#39;</span><span class="o">:</span> <span class="nx">fval</span> <span class="p">}</span> <span class="o">:</span> <span class="p">{</span> <span class="s1">&#39;lgrad&#39;</span><span class="o">:</span> <span class="nx">fval</span> <span class="p">}));</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">path</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">path</span><span class="p">.</span><span class="nx">fill</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">f</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">text</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">text</span><span class="p">.</span><span class="nx">fill</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">f</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <blockquote>
  <p>builder.fill % (color: String) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">stroke</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">sval</span><span class="p">,</span> <span class="nx">width</span><span class="p">,</span> <span class="nx">cap</span><span class="p">,</span> <span class="nx">join</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">s</span> <span class="o">=</span> <span class="p">((</span><span class="k">typeof</span> <span class="nx">sval</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="p">{</span>
        <span class="s1">&#39;width&#39;</span><span class="o">:</span> <span class="p">(</span><span class="nx">width</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="o">?</span> <span class="nx">width</span>
                 <span class="o">:</span> <span class="nx">Builder</span><span class="p">.</span><span class="nx">DEFAULT_STROKE</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span>
        <span class="s1">&#39;color&#39;</span><span class="o">:</span> <span class="nx">sval</span><span class="p">,</span>
        <span class="s1">&#39;cap&#39;</span><span class="o">:</span> <span class="nx">cap</span> <span class="o">||</span> <span class="nx">Builder</span><span class="p">.</span><span class="nx">DEFAULT_CAP</span><span class="p">,</span>
        <span class="s1">&#39;join&#39;</span><span class="o">:</span> <span class="nx">join</span> <span class="o">||</span> <span class="nx">Builder</span><span class="p">.</span><span class="nx">DEFAULT_JOIN</span>
    <span class="p">}</span> <span class="o">:</span> <span class="p">(</span><span class="nx">sval</span><span class="p">.</span><span class="nx">r</span> <span class="o">?</span> <span class="p">{</span> <span class="s1">&#39;rgrad&#39;</span><span class="o">:</span> <span class="nx">sval</span> <span class="p">}</span> <span class="o">:</span> <span class="p">{</span> <span class="s1">&#39;lgrad&#39;</span><span class="o">:</span> <span class="nx">sval</span> <span class="p">}));</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">path</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">path</span><span class="p">.</span><span class="nx">stroke</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">s</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">text</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">text</span><span class="p">.</span><span class="nx">stroke</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">s</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <blockquote>
  <p>builder.stroke % (color: String[, width: Float,
                      cap: String, join: String]) // C.PC_*
                   => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">nofill</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">f</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">path</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">path</span><span class="p">.</span><span class="nx">fill</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">text</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">text</span><span class="p">.</span><span class="nx">fill</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <blockquote>
  <p>builder.nofill % () => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">nostroke</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">s</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">path</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">path</span><span class="p">.</span><span class="nx">stroke</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">text</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">text</span><span class="p">.</span><span class="nx">stroke</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <blockquote>
  <p>builder.nostroke % () => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <ul>
<li>STATIC MODIFICATION *</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">reg</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">pt</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
    <span class="nx">x</span><span class="p">.</span><span class="nx">reg</span> <span class="o">=</span> <span class="nx">pt</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span>
<span class="nx">C</span><span class="p">.</span><span class="nx">R_TL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">C</span><span class="p">.</span><span class="nx">R_TC</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span> <span class="nx">C</span><span class="p">.</span><span class="nx">R_TR</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="nx">C</span><span class="p">.</span><span class="nx">R_ML</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span> <span class="nx">C</span><span class="p">.</span><span class="nx">R_MC</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">C</span><span class="p">.</span><span class="nx">R_MR</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
<span class="nx">C</span><span class="p">.</span><span class="nx">R_BL</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="nx">C</span><span class="p">.</span><span class="nx">R_BC</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span> <span class="nx">C</span><span class="p">.</span><span class="nx">R_BR</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <blockquote>
  <p>builder.reg % (pt: Array[2,Integer]) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">regAt</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">side</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="nx">_new</span> <span class="o">=</span> <span class="nx">x</span><span class="p">.</span><span class="nx">reg</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">lbounds</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">b</span><span class="p">)</span> <span class="k">return</span> <span class="k">this</span><span class="p">;</span> <span class="c1">// throw error?</span>
    <span class="kd">var</span> <span class="nx">w</span> <span class="o">=</span> <span class="nx">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="nx">b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="nx">h</span> <span class="o">=</span> <span class="nx">b</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="nx">b</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="k">switch</span> <span class="p">(</span><span class="nx">side</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">case</span> <span class="nx">C</span><span class="p">.</span><span class="nx">R_TL</span><span class="o">:</span> <span class="nx">_new</span> <span class="o">=</span> <span class="p">[</span> <span class="o">-</span><span class="nx">w</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="nx">h</span><span class="o">/</span><span class="mi">2</span> <span class="p">];</span> <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="nx">C</span><span class="p">.</span><span class="nx">R_TC</span><span class="o">:</span> <span class="nx">_new</span> <span class="o">=</span> <span class="p">[</span>    <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="nx">h</span><span class="o">/</span><span class="mi">2</span> <span class="p">];</span> <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="nx">C</span><span class="p">.</span><span class="nx">R_TR</span><span class="o">:</span> <span class="nx">_new</span> <span class="o">=</span> <span class="p">[</span>  <span class="nx">w</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="nx">h</span><span class="o">/</span><span class="mi">2</span> <span class="p">];</span> <span class="k">break</span><span class="p">;</span>

        <span class="k">case</span> <span class="nx">C</span><span class="p">.</span><span class="nx">R_ML</span><span class="o">:</span> <span class="nx">_new</span> <span class="o">=</span> <span class="p">[</span> <span class="o">-</span><span class="nx">w</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>    <span class="mi">0</span> <span class="p">];</span> <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="nx">C</span><span class="p">.</span><span class="nx">R_MC</span><span class="o">:</span> <span class="nx">_new</span> <span class="o">=</span> <span class="p">[</span>    <span class="mi">0</span><span class="p">,</span>    <span class="mi">0</span> <span class="p">];</span> <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="nx">C</span><span class="p">.</span><span class="nx">R_MR</span><span class="o">:</span> <span class="nx">_new</span> <span class="o">=</span> <span class="p">[</span>  <span class="nx">w</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>    <span class="mi">0</span> <span class="p">];</span> <span class="k">break</span><span class="p">;</span>

        <span class="k">case</span> <span class="nx">C</span><span class="p">.</span><span class="nx">R_BL</span><span class="o">:</span> <span class="nx">_new</span> <span class="o">=</span> <span class="p">[</span> <span class="o">-</span><span class="nx">w</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>  <span class="nx">h</span><span class="o">/</span><span class="mi">2</span> <span class="p">];</span> <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="nx">C</span><span class="p">.</span><span class="nx">R_BC</span><span class="o">:</span> <span class="nx">_new</span> <span class="o">=</span> <span class="p">[</span>    <span class="mi">0</span><span class="p">,</span>  <span class="nx">h</span><span class="o">/</span><span class="mi">2</span> <span class="p">];</span> <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="nx">C</span><span class="p">.</span><span class="nx">R_BR</span><span class="o">:</span> <span class="nx">_new</span> <span class="o">=</span> <span class="p">[</span>  <span class="nx">w</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>  <span class="nx">h</span><span class="o">/</span><span class="mi">2</span> <span class="p">];</span> <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">x</span><span class="p">.</span><span class="nx">reg</span> <span class="o">=</span> <span class="nx">_new</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <blockquote>
  <p>builder.reg % (side: C.R_*) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">move</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">pt</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
    <span class="nx">x</span><span class="p">.</span><span class="nx">pos</span> <span class="o">=</span> <span class="p">[</span> <span class="nx">x</span><span class="p">.</span><span class="nx">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="nx">pt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
              <span class="nx">x</span><span class="p">.</span><span class="nx">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="nx">pt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">];</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-29">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-29">&#182;</a>               </div>               <blockquote>
  <p>builder.move % (pt: Array[2,Integer]) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">zoom</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">path</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">path</span><span class="p">.</span><span class="nx">zoom</span><span class="p">(</span><span class="nx">val</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">path</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">path</span><span class="p">);</span> <span class="c1">// will normalize it</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-30">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-30">&#182;</a>               </div>               <blockquote>
  <p>builder.zoom % (val: Array[2,Float]) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">bounds</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">bounds</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">bounds</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">4</span><span class="p">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Incorrect bounds&#39;</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">__bounds</span> <span class="o">=</span> <span class="nx">bounds</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-31">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-31">&#182;</a>               </div>               <blockquote>
  <p>builder.bounds % (val: Array[4,Float]) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-32">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-32">&#182;</a>               </div>               <ul>
<li>BANDS *</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">band</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">band</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">setBand</span><span class="p">(</span><span class="nx">band</span><span class="p">);</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-33">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-33">&#182;</a>               </div>               <blockquote>
  <p>builder.band % (band: Array[2,Float]) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-34">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-34">&#182;</a>               </div>               <ul>
<li>TWEENS *</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">tween</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">band</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">easing</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">addTween</span><span class="p">({</span>
        <span class="nx">type</span><span class="o">:</span> <span class="nx">type</span><span class="p">,</span>
        <span class="nx">time</span><span class="o">:</span> <span class="nx">band</span><span class="p">,</span>
        <span class="nx">data</span><span class="o">:</span> <span class="nx">data</span><span class="p">,</span>
        <span class="nx">easing</span><span class="o">:</span> <span class="nx">easing</span>
    <span class="p">});</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-35">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-35">&#182;</a>               </div>               <blockquote>
  <p>builder.tween % (type: String, // (C.T<em>*)
                     band: Array[2,Float],
                     data: Any,
                     [easing: String (Easing.T</em>*) | Object | Function]) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">rtween</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">band</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">easing</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-36">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-36">&#182;</a>               </div>               <blockquote>
  <p>builder.tween % (type: String, // (C.T<em>*)
                     band: Array[2,Float],
                     data: Any,
                     [easing: String (Easing.T</em>*) | Object | Function]) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">addTween</span><span class="p">({</span>
        <span class="nx">type</span><span class="o">:</span> <span class="nx">type</span><span class="p">,</span>
        <span class="nx">time</span><span class="o">:</span> <span class="nx">band</span><span class="p">,</span>
        <span class="nx">data</span><span class="o">:</span> <span class="nx">data</span><span class="p">,</span>
        <span class="nx">easing</span><span class="o">:</span> <span class="nx">easing</span><span class="p">,</span>
        <span class="nx">relative</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">});</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-37">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-37">&#182;</a>               </div>               <p>TODO: add relative tweens for all versions (+ include them in tests)</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">untween</span> <span class="o">=</span> <span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">unmodify</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-38">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-38">&#182;</a>               </div>               <p>FIXME: add rtrans, rscale, ralpha and s.o.</p>

<blockquote>
  <p>builder.untween % (tween: Function) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">rotate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">band</span><span class="p">,</span> <span class="nx">angles</span><span class="p">,</span> <span class="nx">easing</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">tween</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">T_ROTATE</span><span class="p">,</span> <span class="nx">band</span><span class="p">,</span> <span class="nx">angles</span><span class="p">,</span> <span class="nx">easing</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-39">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-39">&#182;</a>               </div>               <blockquote>
  <p>builder.rotate % (band: Array[2,Float],
                      angles: Array[2,Float],
                      [easing: String]) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">rotateP</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">band</span><span class="p">,</span> <span class="nx">easing</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-40">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-40">&#182;</a>               </div>               <blockquote>
  <p>builder.rotateP % (band: Array[2,Float],
                       [easing: String]) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">tween</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">T_ROT_TO_PATH</span><span class="p">,</span> <span class="nx">band</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">easing</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-41">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-41">&#182;</a>               </div>               <p>FIXME: take band from translate tween, if it is not defined</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">scale</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">band</span><span class="p">,</span> <span class="nx">values</span><span class="p">,</span> <span class="nx">easing</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">tween</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">T_SCALE</span><span class="p">,</span> <span class="nx">band</span><span class="p">,</span> <span class="nx">values</span><span class="p">,</span> <span class="nx">easing</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-42">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-42">&#182;</a>               </div>               <blockquote>
  <p>builder.scale % (band: Array[2,Float],
                     values: Array[2,Array[2, Float]],
                     [easing: String]) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">xscale</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">band</span><span class="p">,</span> <span class="nx">values</span><span class="p">,</span> <span class="nx">easing</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">scale</span><span class="p">(</span><span class="nx">band</span><span class="p">,</span> <span class="p">[</span> <span class="p">[</span> <span class="nx">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">],</span>
                              <span class="p">[</span> <span class="nx">values</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nx">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">]</span> <span class="p">],</span> <span class="nx">easing</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-43">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-43">&#182;</a>               </div>               <blockquote>
  <p>builder.xscale % (band: Array[2,Float],
                      values: Array[2, Float],
                      [easing: String]) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">trans</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">band</span><span class="p">,</span> <span class="nx">points</span><span class="p">,</span> <span class="nx">easing</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">transP</span><span class="p">(</span><span class="nx">band</span><span class="p">,</span> <span class="p">[[</span><span class="nx">points</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="nx">points</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]],</span>
                              <span class="p">[</span><span class="nx">points</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="nx">points</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]]],</span> <span class="nx">easing</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-44">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-44">&#182;</a>               </div>               <blockquote>
  <p>builder.trans % (band: Array[2,Float],
                     points: Array[2,Array[2, Float]],
                     [easing: String]) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">transP</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">band</span><span class="p">,</span> <span class="nx">path</span><span class="p">,</span> <span class="nx">easing</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">tween</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">T_TRANSLATE</span><span class="p">,</span> <span class="nx">band</span><span class="p">,</span> <span class="nx">Builder</span><span class="p">.</span><span class="nx">__path</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">path</span><span class="p">),</span> <span class="nx">easing</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-45">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-45">&#182;</a>               </div>               <blockquote>
  <p>builder.transP % (band: Array[2,Float],
                      path: String | Path,
                      [easing: String]) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">alpha</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">band</span><span class="p">,</span> <span class="nx">values</span><span class="p">,</span> <span class="nx">easing</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">tween</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">T_ALPHA</span><span class="p">,</span> <span class="nx">band</span><span class="p">,</span> <span class="nx">values</span><span class="p">,</span> <span class="nx">easing</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-46">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-46">&#182;</a>               </div>               <blockquote>
  <p>builder.alpha % (band: Array[2,Float],
                     values: Array[2,Float],
                     [easing: String]) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-47">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-47">&#182;</a>               </div>               <ul>
<li>REPEAT MODES *</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">mode</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">mode</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">mode</span> <span class="o">=</span> <span class="nx">mode</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-48">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-48">&#182;</a>               </div>               <blockquote>
  <p>builder.mode % (mode: String) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">once</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">mode</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">R_ONCE</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-49">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-49">&#182;</a>               </div>               <blockquote>
  <p>builder.once % () => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">stay</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">mode</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">R_STAY</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-50">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-50">&#182;</a>               </div>               <blockquote>
  <p>builder.stay % () => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">loop</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">mode</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">R_LOOP</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-51">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-51">&#182;</a>               </div>               <blockquote>
  <p>builder.loop % () => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">bounce</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">mode</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nx">R_BOUNCE</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-52">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-52">&#182;</a>               </div>               <blockquote>
  <p>builder.bounce % () => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-53">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-53">&#182;</a>               </div>               <ul>
<li>MODIFIERS &amp; PAINTERS *</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">modify</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">band</span><span class="p">,</span> <span class="nx">modifier</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">easing</span><span class="p">,</span> <span class="nx">priority</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">is</span><span class="p">.</span><span class="nx">array</span><span class="p">(</span><span class="nx">band</span><span class="p">)</span> <span class="o">||</span> <span class="nx">is</span><span class="p">.</span><span class="nx">num</span><span class="p">(</span><span class="nx">band</span><span class="p">))</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-54">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-54">&#182;</a>               </div>               <blockquote>
  <p>builder.modify % ([band: Array[2, Float],]
                      modifier: Function(time: Float,
                                         data: Any),
                      [data: Any, easing: Function(time),
                                  priority: Integer]) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">addModifier</span><span class="p">({</span> <span class="nx">time</span><span class="o">:</span> <span class="nx">band</span><span class="p">,</span>
                             <span class="nx">easing</span><span class="o">:</span> <span class="nx">easing</span><span class="p">,</span>
                             <span class="nx">data</span><span class="o">:</span> <span class="nx">data</span><span class="p">,</span>
                             <span class="nx">priority</span><span class="o">:</span> <span class="nx">priority</span> <span class="p">},</span> <span class="nx">modifier</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-55">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-55">&#182;</a>               </div>               <p>NB: easing and data are currently "swapped" in <code>modify</code> method</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">priority</span> <span class="o">=</span> <span class="nx">easing</span><span class="p">;</span>
        <span class="nx">easing</span> <span class="o">=</span> <span class="nx">data</span><span class="p">;</span>
        <span class="nx">data</span> <span class="o">=</span> <span class="nx">modifier</span><span class="p">;</span>
        <span class="nx">modifier</span> <span class="o">=</span> <span class="nx">band</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-56">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-56">&#182;</a>               </div>               <p>match actual arguments, if band was omitted</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">addModifier</span><span class="p">({</span> <span class="nx">easing</span><span class="o">:</span> <span class="nx">easing</span><span class="p">,</span>
                             <span class="nx">data</span><span class="o">:</span> <span class="nx">data</span><span class="p">,</span>
                             <span class="nx">priority</span><span class="o">:</span> <span class="nx">priority</span> <span class="p">},</span> <span class="nx">modifier</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-57">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-57">&#182;</a>               </div>               <p>NB: easing and data are currently "swapped" in <code>modify</code> method</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">rmodify</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">band</span><span class="p">,</span> <span class="nx">modifier</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">easing</span><span class="p">,</span> <span class="nx">priority</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">is</span><span class="p">.</span><span class="nx">array</span><span class="p">(</span><span class="nx">band</span><span class="p">)</span> <span class="o">||</span> <span class="nx">is</span><span class="p">.</span><span class="nx">num</span><span class="p">(</span><span class="nx">band</span><span class="p">))</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-58">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-58">&#182;</a>               </div>               <blockquote>
  <p>builder.rmodify % ([band: Array[2, Float],]
                       modifier: Function(time: Float,
                                          data: Any),
                       [data: Any, easing: Function(time),
                                   priority: Integer]) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">addModifier</span><span class="p">({</span> <span class="nx">time</span><span class="o">:</span> <span class="nx">band</span><span class="p">,</span>
                             <span class="nx">easing</span><span class="o">:</span> <span class="nx">easing</span><span class="p">,</span>
                             <span class="nx">data</span><span class="o">:</span> <span class="nx">data</span><span class="p">,</span>
                             <span class="nx">relative</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
                             <span class="nx">priority</span><span class="o">:</span> <span class="nx">priority</span> <span class="p">},</span> <span class="nx">modifier</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-59">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-59">&#182;</a>               </div>               <p>NB: easing and data are currently "swapped" in <code>modify</code> method</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">priority</span> <span class="o">=</span> <span class="nx">easing</span><span class="p">;</span>
        <span class="nx">easing</span> <span class="o">=</span> <span class="nx">data</span><span class="p">;</span>
        <span class="nx">data</span> <span class="o">=</span> <span class="nx">modifier</span><span class="p">;</span>
        <span class="nx">modifier</span> <span class="o">=</span> <span class="nx">band</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-60">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-60">&#182;</a>               </div>               <p>match actual arguments, if band was omitted</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">addModifier</span><span class="p">({</span> <span class="nx">easing</span><span class="o">:</span> <span class="nx">easing</span><span class="p">,</span>
                             <span class="nx">data</span><span class="o">:</span> <span class="nx">data</span><span class="p">,</span>
                             <span class="nx">relative</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
                             <span class="nx">priority</span><span class="o">:</span> <span class="nx">priority</span> <span class="p">},</span> <span class="nx">modifier</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-61">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-61">&#182;</a>               </div>               <p>NB: easing and data are currently "swapped" in <code>modify</code> method</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">paint</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">func</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">priority</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">addPainter</span><span class="p">(</span><span class="nx">func</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">priority</span><span class="p">);</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-62">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-62">&#182;</a>               </div>               <blockquote>
  <p>builder.paint % (painter: Function(ctx: Context,
                                       data: Any),
                     [data: Any, priority: Integer]) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">at</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">t</span><span class="p">,</span> <span class="nx">func</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">priority</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">modify</span><span class="p">(</span><span class="nx">t</span><span class="p">,</span> <span class="nx">func</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">priority</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-63">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-63">&#182;</a>               </div>               <blockquote>
  <p>builder.at % (t: time, modifier: Function(time: Float,
                                              data: Any),
                  [data: Any, priority: Integer]) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">rat</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">t</span><span class="p">,</span> <span class="nx">func</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">priority</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">rmodify</span><span class="p">(</span><span class="nx">t</span><span class="p">,</span> <span class="nx">func</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">priority</span><span class="p">);</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-64">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-64">&#182;</a>               </div>               <blockquote>
  <p>builder.rat % (t: time, modifier: Function(time: Float,
                                               data: Any),
                   [data: Any, priority: Integer]) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">unmodify</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">modifier</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">removeModifier</span><span class="p">(</span><span class="nx">modifier</span><span class="p">);</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-65">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-65">&#182;</a>               </div>               <blockquote>
  <p>builder.unmodify % (modifier: Function) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">unpaint</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">painter</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">removePainter</span><span class="p">(</span><span class="nx">painter</span><span class="p">);</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-66">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-66">&#182;</a>               </div>               <blockquote>
  <p>builder.unpaint % (painter: Function) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-67">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-67">&#182;</a>               </div>               <ul>
<li>TIME-SWITCH *</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">key</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-68">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-68">&#182;</a>               </div>               <blockquote>
  <p>builder.key % (name: String, value: Float) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">keys</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-69">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-69">&#182;</a>               </div>               <p>TODO: ensure value is in band?</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">time</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">tf</span> <span class="o">=</span> <span class="nx">f</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-70">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-70">&#182;</a>               </div>               <blockquote>
  <p>builder.time % (f: Function(t: Float)) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">tease</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ease</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">ease</span><span class="p">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Ease function not defined&#39;</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">duration</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">duration</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">time</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">t</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">ease</span><span class="p">(</span><span class="nx">t</span> <span class="o">/</span> <span class="nx">duration</span><span class="p">);</span>
    <span class="p">});</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-71">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-71">&#182;</a>               </div>               <blockquote>
  <p>builder.tease % (ease: Function(t: Float)) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-72">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-72">&#182;</a>               </div>               <ul>
<li>EVENTS *</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">on</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">handler</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">m_on</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">handler</span><span class="p">);</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-73">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-73">&#182;</a>               </div>               <blockquote>
  <p>builder.on % (type: String, handler: Function(evt: Event, t: Float)) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">unhandle</span> <span class="o">=</span> <span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">unmodify</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-74">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-74">&#182;</a>               </div>               <blockquote>
  <p>builder.unhandle % (handler: Function) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-75">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-75">&#182;</a>               </div>               <ul>
<li>TAKE &amp; USE *</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">take</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">n</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">n</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-76">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-76">&#182;</a>               </div>               <blockquote>
  <p>builder.take % (b: Builder) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">this</span><span class="p">.</span><span class="nx">v</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">clone</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">xdata</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-77">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-77">&#182;</a>               </div>               <p>xdata contents points to the same objects
as source's xdata do</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">use</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">n</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">n</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-78">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-78">&#182;</a>               </div>               <blockquote>
  <p>builder.copy % (b: Builder) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">this</span><span class="p">.</span><span class="nx">v</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">deepClone</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">xdata</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-79">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-79">&#182;</a>               </div>               <p>xdata takes the clones of the objects
source's xdata points do</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-80">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-80">&#182;</a>               </div>               <ul>
<li>ENABLE &amp; DISABLE *</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">disable</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">disabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">travelChildren</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">elm</span><span class="p">)</span> <span class="p">{</span> <span class="nx">elm</span><span class="p">.</span><span class="nx">disabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span> <span class="p">});</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-81">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-81">&#182;</a>               </div>               <blockquote>
  <p>builder.disable % () => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">enable</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">disabled</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">travelChildren</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">elm</span><span class="p">)</span> <span class="p">{</span> <span class="nx">elm</span><span class="p">.</span><span class="nx">disabled</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span> <span class="p">});</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-82">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-82">&#182;</a>               </div>               <blockquote>
  <p>builder.enable % () => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-83">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-83">&#182;</a>               </div>               <ul>
<li>ITERATIONS *</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">each</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">func</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">visitChildren</span><span class="p">(</span><span class="nx">func</span><span class="p">);</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-84">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-84">&#182;</a>               </div>               <blockquote>
  <p>builder.each % (visitor: Function(elm: Element)) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">deach</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">func</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">travelChildren</span><span class="p">(</span><span class="nx">func</span><span class="p">);</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-85">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-85">&#182;</a>               </div>               <blockquote>
  <p>builder.deach % (visitor: Function(elm: Element)) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">iter</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">func</span><span class="p">,</span> <span class="nx">rfunc</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">iterateChildren</span><span class="p">(</span><span class="nx">func</span><span class="p">,</span> <span class="nx">rfunc</span><span class="p">);</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-86">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-86">&#182;</a>               </div>               <blockquote>
  <p>builder.iter % (visitor: Function(elm: Element),
                    [onremove: Function(elm: Element)]) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">diter</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">func</span><span class="p">,</span> <span class="nx">rfunc</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">deepIterateChildren</span><span class="p">(</span><span class="nx">func</span><span class="p">,</span> <span class="nx">rfunc</span><span class="p">);</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-87">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-87">&#182;</a>               </div>               <blockquote>
  <p>builder.diter % (visitor: Function(elm: Element),
                     [onremove: Function(elm: Element)]) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-88">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-88">&#182;</a>               </div>               <ul>
<li>DETACH &amp; CLEAR *</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">detach</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">detach</span><span class="p">();</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-89">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-89">&#182;</a>               </div>               <blockquote>
  <p>builder.detach % () => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">clear</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-90">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-90">&#182;</a>               </div>               <blockquote>
  <p>builder.clear % () => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-91">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-91">&#182;</a>               </div>               <ul>
<li>DATA *</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">value</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">data</span><span class="p">();</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-92">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-92">&#182;</a>               </div>               <blockquote>
  <p>builder.data % ([val: value]) => Builder</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">acomp</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">acomp</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*if (modCollisions) { // IF Collisions Module enabled</span>


<span class="cm">//DIVIDER</span>
<span class="cm">    Builder.prototype.local = function(pt, t) {</span>
<span class="cm">        return this.v.local(pt, t);</span>
<span class="cm">    }</span>

<span class="cm">//DIVIDER</span>
<span class="cm">    Builder.prototype.global = function(pt, t) {</span>
<span class="cm">        return this.v.global(pt, t);</span>
<span class="cm">    }</span>
<span class="cm">    Builder.prototype.bounds = function(t) {</span>
<span class="cm">        return this.v.bounds(t);</span>
<span class="cm">    }</span>
<span class="cm">    Builder.prototype.bounds = function(t) {</span>
<span class="cm">        return this.v.bounds(t);</span>
<span class="cm">    }</span>


<span class="cm">//DIVIDER</span>

<span class="cm">} // end IF modCollisions*/</span></pre></div>             </td>           </tr>                               <tr id="section-93">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-93">&#182;</a>               </div>               <ul>
<li>COMPOSITING *</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">mask</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">mask</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">mask</span> <span class="k">instanceof</span> <span class="nx">Element</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">setMask</span><span class="p">(</span><span class="nx">mask</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">mask</span> <span class="k">instanceof</span> <span class="nx">Builder</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">v</span><span class="p">.</span><span class="nx">setMask</span><span class="p">(</span><span class="nx">mask</span><span class="p">.</span><span class="nx">v</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-94">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-94">&#182;</a>               </div>               <blockquote>
  <p>builder.local % (pt: Array[2, Float]) => Array[2, Float]</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">_extractStroke</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">def_</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">path</span><span class="p">)</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">path</span><span class="p">.</span><span class="nx">stroke</span> <span class="o">||</span> <span class="nx">def_</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">text</span><span class="p">)</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">text</span><span class="p">.</span><span class="nx">stroke</span> <span class="o">||</span> <span class="nx">def_</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">def_</span><span class="p">;</span>
<span class="p">}</span>
<span class="nx">Builder</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">_extractFill</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">def_</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">path</span><span class="p">)</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">path</span><span class="p">.</span><span class="nx">fill</span> <span class="o">||</span> <span class="nx">def_</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">text</span><span class="p">)</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">text</span><span class="p">.</span><span class="nx">fill</span> <span class="o">||</span> <span class="nx">def_</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">def_</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-95">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-95">&#182;</a>               </div>               <blockquote>
  <p>builder.global % (pt: Array[2, Float]) => Array[2, Float]</p>
</blockquote>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">rgb</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">r</span><span class="p">,</span> <span class="nx">g</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">&quot;rgba(&quot;</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">r</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span>
                     <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">g</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span>
                     <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span>
                     <span class="p">((</span><span class="k">typeof</span> <span class="nx">a</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span>
                            <span class="o">?</span> <span class="nx">a</span> <span class="o">:</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="nx">Builder</span><span class="p">.</span><span class="nx">frgb</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">r</span><span class="p">,</span> <span class="nx">g</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">B</span><span class="p">.</span><span class="nx">rgb</span><span class="p">(</span><span class="nx">r</span><span class="o">*</span><span class="mi">255</span><span class="p">,</span><span class="nx">g</span><span class="o">*</span><span class="mi">255</span><span class="p">,</span><span class="nx">b</span><span class="o">*</span><span class="mi">255</span><span class="p">,</span><span class="nx">a</span><span class="p">);</span>
<span class="p">}</span>
<span class="nx">Builder</span><span class="p">.</span><span class="nx">hsv</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">h</span><span class="p">,</span> <span class="nx">s</span><span class="p">,</span> <span class="nx">v</span><span class="p">,</span> <span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">B</span><span class="p">.</span><span class="nx">fhsv</span><span class="p">(</span><span class="nx">h</span><span class="o">/</span><span class="mi">360</span><span class="p">,</span><span class="nx">s</span><span class="p">,</span><span class="nx">v</span><span class="p">,</span><span class="nx">a</span><span class="p">);</span>
<span class="p">}</span>
<span class="nx">Builder</span><span class="p">.</span><span class="nx">fhsv</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">h</span><span class="p">,</span> <span class="nx">s</span><span class="p">,</span> <span class="nx">v</span><span class="p">,</span> <span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">v</span> <span class="o">*</span> <span class="nx">s</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">h1</span> <span class="o">=</span> <span class="nx">h</span> <span class="o">*</span> <span class="mi">6</span><span class="p">;</span> <span class="c1">// h * 360 / 60</span>
    <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">c</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">((</span><span class="nx">h1</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">));</span>
    <span class="kd">var</span> <span class="nx">m</span> <span class="o">=</span> <span class="nx">v</span> <span class="o">-</span> <span class="nx">c</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">rgb</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">h1</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="nx">rgb</span> <span class="o">=</span> <span class="p">[</span><span class="nx">c</span><span class="p">,</span> <span class="nx">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">];</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">h1</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="nx">rgb</span> <span class="o">=</span> <span class="p">[</span><span class="nx">x</span><span class="p">,</span> <span class="nx">c</span><span class="p">,</span> <span class="mi">0</span><span class="p">];</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">h1</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="nx">rgb</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="nx">c</span><span class="p">,</span> <span class="nx">x</span><span class="p">];</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">h1</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="nx">rgb</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">c</span><span class="p">];</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">h1</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">)</span> <span class="nx">rgb</span> <span class="o">=</span> <span class="p">[</span><span class="nx">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">c</span><span class="p">];</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">h1</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="p">)</span> <span class="nx">rgb</span> <span class="o">=</span> <span class="p">[</span><span class="nx">c</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">x</span><span class="p">];</span>

    <span class="k">return</span> <span class="nx">Builder</span><span class="p">.</span><span class="nx">rgb</span><span class="p">(</span><span class="mi">255</span> <span class="o">*</span> <span class="p">(</span><span class="nx">rgb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="nx">m</span><span class="p">),</span>
                       <span class="mi">255</span> <span class="o">*</span> <span class="p">(</span><span class="nx">rgb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="nx">m</span><span class="p">),</span>
                       <span class="mi">255</span> <span class="o">*</span> <span class="p">(</span><span class="nx">rgb</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="nx">m</span><span class="p">),</span> <span class="nx">a</span><span class="p">);</span>
<span class="p">}</span>
<span class="nx">Builder</span><span class="p">.</span><span class="nx">lgrad</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">dir</span><span class="p">,</span> <span class="nx">stops</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="nx">dir</span><span class="o">:</span> <span class="nx">dir</span><span class="p">,</span>
        <span class="nx">stops</span><span class="o">:</span> <span class="nx">stops</span>
    <span class="p">};</span>
<span class="p">}</span>
<span class="nx">Builder</span><span class="p">.</span><span class="nx">rgrad</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">dir</span><span class="p">,</span> <span class="nx">rad</span><span class="p">,</span> <span class="nx">stops</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="nx">dir</span><span class="o">:</span> <span class="nx">dir</span><span class="p">,</span>
        <span class="nx">r</span><span class="o">:</span> <span class="nx">rad</span><span class="p">,</span>
        <span class="nx">stops</span><span class="o">:</span> <span class="nx">stops</span>
    <span class="p">};</span>
<span class="p">}</span>
<span class="nx">Builder</span><span class="p">.</span><span class="nx">path</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">points</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">p</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Path</span><span class="p">();</span>
    <span class="nx">p</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">MSeg</span><span class="p">([</span><span class="nx">points</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nx">points</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]]));</span>
    <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">pl</span> <span class="o">=</span> <span class="nx">points</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">pl</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">pts</span> <span class="o">=</span> <span class="nx">points</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">pts</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">p</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">LSeg</span><span class="p">([</span> <span class="nx">pts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">pts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">]));</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">p</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">CSeg</span><span class="p">([</span> <span class="nx">pts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">pts</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                             <span class="nx">pts</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nx">pts</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                             <span class="nx">pts</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="nx">pts</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="p">]));</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="cm">/*p.add(new MSeg([ points[pl-1][0], points[pl-1][1] ]));*/</span>
    <span class="k">return</span> <span class="nx">p</span><span class="p">;</span>
<span class="p">}</span>
<span class="nx">Builder</span><span class="p">.</span><span class="nx">easing</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">func</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;f&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">func</span><span class="p">;</span> <span class="p">},</span>
        <span class="s1">&#39;data&#39;</span><span class="o">:</span> <span class="nx">data</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="nx">Builder</span><span class="p">.</span><span class="nx">easingF</span> <span class="o">=</span> <span class="nx">Builder</span><span class="p">.</span><span class="nx">easing</span><span class="p">;</span> <span class="c1">// type: C.E_FUNC</span>
<span class="nx">Builder</span><span class="p">.</span><span class="nx">easingP</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span> <span class="nx">type</span><span class="o">:</span> <span class="nx">C</span><span class="p">.</span><span class="nx">E_PATH</span><span class="p">,</span> <span class="nx">data</span><span class="o">:</span> <span class="nx">Builder</span><span class="p">.</span><span class="nx">__path</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="p">};</span>
<span class="p">}</span>
<span class="nx">Builder</span><span class="p">.</span><span class="nx">easingC</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">seg</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span> <span class="nx">type</span><span class="o">:</span> <span class="nx">C</span><span class="p">.</span><span class="nx">E_CSEG</span><span class="p">,</span>
        <span class="nx">data</span><span class="o">:</span> <span class="p">((</span><span class="nx">seg</span> <span class="k">instanceof</span> <span class="nx">CSeg</span><span class="p">)</span>
               <span class="o">?</span> <span class="nx">seg</span> <span class="o">:</span> <span class="k">new</span> <span class="nx">CSeg</span><span class="p">(</span><span class="nx">seg</span><span class="p">))</span> <span class="p">};</span>
<span class="p">}</span>
<span class="nx">Builder</span><span class="p">.</span><span class="nx">tween</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-96">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-96">&#182;</a>               </div>               <p>TODO: bounds, dbounds, contains, dcontains,
      collides, dcollides, intersects, dintersects,
      offset, reactAs</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="p">}</span>
<span class="nx">Builder</span><span class="p">.</span><span class="nx">font</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">size</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">fface</span> <span class="o">=</span> <span class="nx">name</span> <span class="o">||</span> <span class="nx">Builder</span><span class="p">.</span><span class="nx">DEFAULT_FFACE</span><span class="p">;</span>
        <span class="nx">fface</span> <span class="o">=</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">fface</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="nx">fface</span> <span class="o">:</span> <span class="nx">fface</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">fsize</span> <span class="o">=</span> <span class="p">(</span><span class="nx">size</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="o">?</span> <span class="nx">size</span> <span class="o">:</span> <span class="nx">Builder</span><span class="p">.</span><span class="nx">DEFAULT_FSIZE</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">fsize</span> <span class="o">+</span> <span class="s1">&#39;px &#39;</span> <span class="o">+</span> <span class="nx">fface</span><span class="p">;</span>
<span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-97">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-97">&#182;</a>               </div>               <ul>
<li>MASKS *</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Builder</span><span class="p">.</span><span class="nx">arcPath</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">centerX</span><span class="p">,</span> <span class="nx">centerY</span><span class="p">,</span> <span class="nx">radius</span><span class="p">,</span> <span class="nx">startAngle</span><span class="p">,</span> <span class="nx">arcAngle</span><span class="p">,</span> <span class="nx">steps</span><span class="p">){</span></pre></div>             </td>           </tr>                               <tr id="section-98">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-98">&#182;</a>               </div>               <ul>
<li>PRIVATE *</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">twoPI</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-99">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-99">&#182;</a>               </div>               <ul>
<li>HELPERS *</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">angleStep</span> <span class="o">=</span> <span class="nx">arcAngle</span><span class="o">/</span><span class="nx">steps</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-100">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-100">&#182;</a>               </div>               <p>FIXME: TODO</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">xx</span> <span class="o">=</span> <span class="nx">centerX</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">startAngle</span> <span class="o">*</span> <span class="nx">twoPI</span><span class="p">)</span> <span class="o">*</span> <span class="nx">radius</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">yy</span> <span class="o">=</span> <span class="nx">centerY</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nx">startAngle</span> <span class="o">*</span> <span class="nx">twoPI</span><span class="p">)</span> <span class="o">*</span> <span class="nx">radius</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-101">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-101">&#182;</a>               </div>               <p>Thanks for Nek (github.com/Nek) for this function</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">res</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="nx">xx</span><span class="p">,</span> <span class="nx">yy</span><span class="p">]);</span></pre></div>             </td>           </tr>                               <tr id="section-102">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-102">&#182;</a>               </div>               <p>For convenience, store the number of radians in a full circle.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;=</span><span class="nx">steps</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span></pre></div>             </td>           </tr>                               <tr id="section-103">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-103">&#182;</a>               </div>               <p>To determine the size of the angle between each point on the
arc, divide the overall angle by the total number of points.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="kd">var</span> <span class="nx">angle</span> <span class="o">=</span> <span class="nx">startAngle</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">*</span> <span class="nx">angleStep</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-104">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-104">&#182;</a>               </div>               <p>Determine coordinates of first point using basic circle math.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">xx</span> <span class="o">=</span> <span class="nx">centerX</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">angle</span> <span class="o">*</span> <span class="nx">twoPI</span><span class="p">)</span> <span class="o">*</span> <span class="nx">radius</span><span class="p">;</span>
        <span class="nx">yy</span> <span class="o">=</span> <span class="nx">centerY</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nx">angle</span> <span class="o">*</span> <span class="nx">twoPI</span><span class="p">)</span> <span class="o">*</span> <span class="nx">radius</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-105">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-105">&#182;</a>               </div>               <p>Move to the first point.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">res</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="nx">xx</span><span class="p">,</span> <span class="nx">yy</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">Builder</span><span class="p">.</span><span class="nx">path</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">prevClone</span> <span class="o">=</span> <span class="nx">Element</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">clone</span><span class="p">;</span>
<span class="nx">Element</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">clone</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">clone</span> <span class="o">=</span> <span class="nx">prevClone</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="nx">clone</span><span class="p">.</span><span class="nx">__b$</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">__b$</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">clone</span><span class="p">;</span>
<span class="p">}</span>

<span class="nb">window</span><span class="p">.</span><span class="nx">Builder</span> <span class="o">=</span> <span class="nx">Builder</span><span class="p">;</span>

<span class="p">})();</span> <span class="c1">// end of anonymous wrapper</span>

</pre></div>             </td>           </tr>                               <tr id="section-106">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-106">&#182;</a>               </div>               <p>Draw a line to each point on the arc.</p>             </td>             <td class="code">               <div class="highlight"><pre>undefined</pre></div>             </td>           </tr>                               <tr id="section-107">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-107">&#182;</a>               </div>               <p>Increment the angle by "angleStep".</p>             </td>             <td class="code">               <div class="highlight"><pre>undefined</pre></div>             </td>           </tr>                               <tr id="section-108">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-108">&#182;</a>               </div>               <p>Determine next point's coordinates using basic circle math.</p>             </td>             <td class="code">               <div class="highlight"><pre>undefined</pre></div>             </td>           </tr>                               <tr id="section-109">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-109">&#182;</a>               </div>               <p>Draw a line to the next point.</p>             </td>             <td class="code">               <div class="highlight"><pre>undefined</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 